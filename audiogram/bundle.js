var app=function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,n=(e||s||Function("return this")()).Symbol,o=Object.prototype,i=o.hasOwnProperty,r=o.toString,a=n?n.toStringTag:void 0;var l=function(t){var e=i.call(t,a),s=t[a];try{t[a]=void 0}catch(t){}var n=r.call(t);return e?t[a]=s:delete t[a],n},c=Object.prototype.toString;var u=function(t){return c.call(t)},h="[object Null]",d="[object Undefined]",p=n?n.toStringTag:void 0;var m=function(t){return null==t?void 0===t?d:h:p&&p in Object(t)?l(t):u(t)};var f=function(t){return null!=t&&"object"==typeof t},_="[object Number]";var v=function(t){return"number"==typeof t||f(t)&&m(t)==_};function g(){}function y(t,e){for(var s in e)t[s]=e[s];return t}function b(t,e){return 0===e&&t(),()=>{--e||t()}}function $(t,e){t.appendChild(e)}function I(t,e,s){t.insertBefore(e,s)}function N(t){t.parentNode.removeChild(t)}function x(t,e){for(var s=0;s<t.length;s+=1)t[s]&&t[s].d(e)}function k(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function S(){return document.createComment("")}function P(t,e,s){t.addEventListener(e,s,!1)}function j(t,e,s){t.removeEventListener(e,s,!1)}function C(t,e){t.data=""+e}function M(t,e,s){t.style.setProperty(e,s)}function q(){return Object.create(null)}function z(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function O(t,e){return t!=t?e==e:t!==e}function R(t,e){var s=t in this._handlers&&this._handlers[t].slice();if(s)for(var n=0;n<s.length;n+=1){var o=s[n];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function H(){return this._state}function F(t,e){t._handlers=q(),t._bind=e._bind,t.options=e,t.root=e.root||t,t.store=e.store||t.root.store}function T(t,e){var s=this._handlers[t]||(this._handlers[t]=[]);return s.push(e),{cancel:function(){var t=s.indexOf(e);~t&&s.splice(t,1)}}}function L(t){t()}function E(t){for(;t&&t.length;)t.shift()()}function V(){this.store._remove(this)}var A={destroy:function(t){this.destroy=g,this.fire("destroy"),this.set=g,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:H,fire:R,on:T,set:function(t){this._set(y({},t)),this.root._lock||(this.root._lock=!0,E(this.root._beforecreate),E(this.root._oncreate),E(this.root._aftercreate),this.root._lock=!1)},_recompute:g,_set:function(t){var e=this._state,s={},n=!1;for(var o in t)this._differs(t[o],e[o])&&(s[o]=n=!0);n&&(this._state=y(y({},e),t),this._recompute(s,this._state),this._bind&&this._bind(s,this._state),this._fragment&&(this.fire("state",{changed:s,current:this._state,previous:e}),this._fragment.p(s,this._state),this.fire("update",{changed:s,current:this._state,previous:e})))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:z};function D(t,e){this._handlers={},this._dependents=[],this._computed=q(),this._sortedComputedProperties=[],this._state=y({},t),this._differs=e&&e.immutable?O:z}y(D.prototype,{_add(t,e){this._dependents.push({component:t,props:e})},_init(t){const e={};for(let s=0;s<t.length;s+=1){const n=t[s];e["$"+n]=this._state[n]}return e},_remove(t){let e=this._dependents.length;for(;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set(t,e){const s=this._state;this._state=y(y({},s),t);for(let t=0;t<this._sortedComputedProperties.length;t+=1)this._sortedComputedProperties[t].update(this._state,e);this.fire("state",{changed:e,previous:s,current:this._state});const n=this._dependents.slice();for(let t=0;t<n.length;t+=1){const s=n[t],o={};let i=!1;for(let t=0;t<s.props.length;t+=1){const n=s.props[t];n in e&&(o["$"+n]=this._state[n],i=!0)}i&&s.component.set(o)}this.fire("update",{changed:e,previous:s,current:this._state})},_sortComputedProperties(){const t=this._computed,e=this._sortedComputedProperties=[],s=q();let n;function o(i){const r=t[i];r&&(r.deps.forEach(t=>{if(t===n)throw new Error(`Cyclical dependency detected between ${t} <-> ${i}`);o(t)}),s[i]||(s[i]=!0,e.push(r)))}for(const t in this._computed)o(n=t)},compute(t,e,s){let n;const o={deps:e,update:(o,i,r)=>{const a=e.map(t=>(t in i&&(r=!0),o[t]));if(r){const e=s.apply(null,a);this._differs(e,n)&&(n=e,i[t]=!0,o[t]=n)}}};this._computed[t]=o,this._sortComputedProperties();const i=y({},this._state),r={};o.update(i,r,!0),this._set(i,r)},fire:R,get:H,on:T,set(t){const e=this._state,s=this._changed={};let n=!1;for(const o in t){if(this._computed[o])throw new Error(`'${o}' is a read-only property`);this._differs(t[o],e[o])&&(s[o]=n=!0)}n&&this._set(t,s)}});const G="frequencies-sets.json",X=10,B={loadedSets:[],setI:null,stepI:null,isPlaying:!1,results:{},modals:{help:!1,export:!1}};function U(t){F(this,t),this._state=y({},t.data),this._intro=!!t.intro,this._fragment=function(t,e){var s,n,o,i,r,a,l;function c(e){t.store.toggleModal("help",!0)}return{c(){s=k("header"),n=k("div"),(o=k("div")).innerHTML='<span class="logo text-uppercase text-primary text-large svelte-17g29ex">Аудиограмма</span>',i=w("\r\n    "),r=k("div"),(a=k("button")).innerHTML='<i class="icon icon-help_outline"></i>\r\n        <span>Помощь</span>',o.className="navbar-section svelte-17g29ex",P(a,"click",c),a.className="btn ml-2",r.className="navbar-section svelte-17g29ex",n.className="navbar container grid-xl svelte-17g29ex",s.className="bg-gray svelte-17g29ex"},m(t,e){I(t,s,e),$(s,n),$(n,o),$(n,i),$(n,r),$(r,a),l=!0},p:g,i(t,e){l||this.m(t,e)},o:L,d(t){t&&N(s),j(a,"click",c)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}y(U.prototype,A);var Y={prepareExport(){this.store.set({isPlaying:!1}),this.store.toggleModal("export",!0)}};function J(t,e){var s,n,o=e.set.name;return{c(){s=k("option"),n=w(o),s.__value=e.i,s.value=s.__value},m(t,e){I(t,s,e),$(s,n)},p(t,e){t.$loadedSets&&o!==(o=e.set.name)&&C(n,o)},d(t){t&&N(s)}}}function K(t,e){var s;return{c(){(s=k("i")).className="icon icon-pause"},m(t,e){I(t,s,e)},d(t){t&&N(s)}}}function Q(t,e){var s;return{c(){(s=k("i")).className="icon icon-play_arrow"},m(t,e){I(t,s,e)},d(t){t&&N(s)}}}function W(t,e,s){const n=Object.create(t);return n.set=e[s],n.each_value=e,n.i=s,n}function Z(t){F(this,t),this._state=y(this.store._init(["loadedSets","setI","stepI","isPlaying","steps"]),t.data),this.store._add(this,["loadedSets","setI","stepI","isPlaying","steps"]),this._intro=!!t.intro,this._handlers.destroy=[V],this._fragment=function(t,e){for(var s,n,o,i,r,a,l,c,u,h,d,p,m,f,_,v,g,y,b,S,C=e.$loadedSets,M=[],q=0;q<C.length;q+=1)M[q]=J(0,W(e,C,q));function z(e){t.store.chooseSet(+this.value)}function O(t){return t.$isPlaying?K:Q}var R=O(e),H=R(t,e);function F(s){t.store.playFrequency(e.$stepI)}function T(s){t.store.playFrequency(e.$stepI-1)}function E(s){t.store.playFrequency(e.$stepI+1)}function V(e){t.prepareExport()}return{c(){s=k("div"),n=k("div"),o=k("div"),i=k("select"),r=k("option"),a=w("Выберите набор частот");for(var t=0;t<M.length;t+=1)M[t].c();l=w("\r\n\r\n    "),c=k("div"),u=k("button"),H.c(),d=w("\r\n      "),(p=k("button")).innerHTML='<i class="icon icon-skip_previous"></i>',f=w("\r\n      "),(_=k("button")).innerHTML='<i class="icon icon-skip_next"></i>',g=w("\r\n\r\n    "),y=k("div"),(b=k("button")).innerHTML='<i class="icon icon-picture_as_pdf"></i>\r\n        <span>Экспорт</span>',r.__value="-1",r.value=r.__value,r.disabled=!0,r.selected=!0,P(i,"change",z),i.className="sets-select form-select",i.name="selected-set",o.className="column col-3",P(u,"click",F),u.className="btn btn-action text-large mr-2",u.disabled=h=null===e.$setI,P(p,"click",T),p.className="btn btn-action text-large mr-2",p.disabled=m=null===e.$stepI||0===e.$stepI,P(_,"click",E),_.className="btn btn-action text-large mr-2",_.disabled=v=null===e.$stepI||e.$stepI===e.$steps.length-1,c.className="column col-2",P(b,"click",V),b.className="btn",y.className="column col-2 col-ml-auto text-right",n.className="columns",s.className="controls form-horizontal svelte-4lj9dp"},m(t,e){I(t,s,e),$(s,n),$(n,o),$(o,i),$(i,r),$(r,a);for(var h=0;h<M.length;h+=1)M[h].m(i,null);$(n,l),$(n,c),$(c,u),H.m(u,null),$(c,d),$(c,p),$(c,f),$(c,_),$(n,g),$(n,y),$(y,b),S=!0},p(s,n){if(e=n,s.$loadedSets){C=e.$loadedSets;for(var o=0;o<C.length;o+=1){const t=W(e,C,o);M[o]?M[o].p(s,t):(M[o]=J(0,t),M[o].c(),M[o].m(i,null))}for(;o<M.length;o+=1)M[o].d(1);M.length=C.length}R!==(R=O(e))&&(H.d(1),(H=R(t,e)).c(),H.m(u,null)),s.$setI&&h!==(h=null===e.$setI)&&(u.disabled=h),s.$stepI&&m!==(m=null===e.$stepI||0===e.$stepI)&&(p.disabled=m),(s.$stepI||s.$steps)&&v!==(v=null===e.$stepI||e.$stepI===e.$steps.length-1)&&(_.disabled=v)},i(t,e){S||this.m(t,e)},o:L,d(t){t&&N(s),x(M,t),j(i,"change",z),H.d(),j(u,"click",F),j(p,"click",T),j(_,"click",E),j(b,"click",V)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function tt(t,e){var s;return{c(){(s=k("i")).className="icon icon-pause"},m(t,e){I(t,s,e)},d(t){t&&N(s)}}}function et(t,e){var s;return{c(){(s=k("i")).className="icon icon-play_arrow"},m(t,e){I(t,s,e)},d(t){t&&N(s)}}}function st(t){F(this,t),this._state=y(this.store._init(["results","setI"]),t.data),this.store._add(this,["results","setI"]),this._recompute({$results:1,$setI:1,stepIndex:1,isPlaying:1},this._state),this._intro=!!t.intro,this._handlers.destroy=[V],this._fragment=function(t,e){var s,n,o,i,r,a,l,c,u,h,d,p,m,f,_,v,g,y,b;function x(t){return t.isPlaying?tt:et}var S=x(e),M=S(t,e);function q(s){t.store.playFrequency(e.stepIndex)}function z(e){t.store.setVolume(this.value)}return{c(){var t,b;s=k("div"),n=k("div"),o=k("button"),M.c(),i=w("\r\n    "),r=k("span"),a=w(e.step),l=w(" Hz"),c=w("\r\n    "),u=k("i"),d=w("\r\n  "),p=k("div"),m=k("input"),_=w("\r\n  "),v=k("div"),g=w(e.volume),y=w("%"),P(o,"click",q),o.className="btn btn-action btn-link mr-2 svelte-1pzjb0i",r.className="mr-2 text-bold",u.className=h="step-status icon "+e.stepStateClass+" svelte-1pzjb0i",n.className="frequency column col-2",P(m,"input",z),m.className="slider mt-1",t="type",b="range",m.setAttribute(t,b),m.min="1",m.max="100",m.step="1",m.value=e.volume,m.disabled=f=!e.isPlaying,p.className="column col-9",v.className="column col-1 text-right",s.className="step-table-row columns py-1 svelte-1pzjb0i"},m(t,e){I(t,s,e),$(s,n),$(n,o),M.m(o,null),$(n,i),$(n,r),$(r,a),$(r,l),$(n,c),$(n,u),$(s,d),$(s,p),$(p,m),$(s,_),$(s,v),$(v,g),$(v,y),b=!0},p(s,n){S!==(S=x(e=n))&&(M.d(1),(M=S(t,e)).c(),M.m(o,null)),s.step&&C(a,e.step),s.stepStateClass&&h!==(h="step-status icon "+e.stepStateClass+" svelte-1pzjb0i")&&(u.className=h),s.volume&&(m.value=e.volume),s.isPlaying&&f!==(f=!e.isPlaying)&&(m.disabled=f),s.volume&&C(g,e.volume)},i(t,e){b||this.m(t,e)},o:L,d(t){t&&N(s),M.d(),j(o,"click",q),j(m,"input",z)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function nt(t,e){var s,n,o,i,r=[ot,it],a=[];function l(t){return t.$isPlaying&&t.$stepI===t.stepIndex?0:1}return s=l(e),n=a[s]=r[s](t,e),{c(){n.c(),o=S()},m(t,e){a[s].m(t,e),I(t,o,e),i=!0},p(e,i){var c=s;(s=l(i))===c?a[s].p(e,i):(n.o(function(){a[c].d(1),a[c]=null}),(n=a[s])||(n=a[s]=r[s](t,i)).c(),n.m(o.parentNode,o))},i(t,e){i||this.m(t,e)},o(t){i&&(n.o(t),i=!1)},d(t){a[s].d(t),t&&N(o)}}}function ot(t,e){var s,n={step:e.step,stepIndex:e.stepIndex,isPlaying:!0},o=new st({root:t.root,store:t.store,data:n});return{c(){o._fragment.c()},m(t,e){o._mount(t,e),s=!0},p(t,e){var s={};t.$steps&&(s.step=e.step),o._set(s)},i(t,e){s||this.m(t,e)},o(t){s&&(o._fragment.o(t),s=!1)},d(t){o.destroy(t)}}}function it(t,e){var s,n={step:e.step,stepIndex:e.stepIndex,isPlaying:!1},o=new st({root:t.root,store:t.store,data:n});return{c(){o._fragment.c()},m(t,e){o._mount(t,e),s=!0},p(t,e){var s={};t.$steps&&(s.step=e.step),o._set(s)},i(t,e){s||this.m(t,e)},o(t){s&&(o._fragment.o(t),s=!1)},d(t){o.destroy(t)}}}function rt(t,e){for(var s,n,o=e.$steps,i=[],r=0;r<o.length;r+=1)i[r]=nt(t,lt(e,o,r));function a(t,e,s){i[t]&&i[t].o(()=>{e&&(i[t].d(e),i[t]=null),s&&s()})}return{c(){for(var t=0;t<i.length;t+=1)i[t].c();s=S()},m(t,e){for(var o=0;o<i.length;o+=1)i[o].i(t,e);I(t,s,e),n=!0},p(e,n){if(e.$isPlaying||e.$stepI||e.$steps){o=n.$steps;for(var r=0;r<o.length;r+=1){const a=lt(n,o,r);i[r]?i[r].p(e,a):(i[r]=nt(t,a),i[r].c()),i[r].i(s.parentNode,s)}for(;r<i.length;r+=1)a(r,1)}},i(t,e){n||this.m(t,e)},o(t){if(!n)return;const e=b(t,i.length);for(let t=0;t<i.length;t+=1)a(t,0,e);n=!1},d(t){x(i,t),t&&N(s)}}}function at(t,e){var s,n;return{c(){(s=k("span")).textContent="No data"},m(t,e){I(t,s,e),n=!0},p:g,i(t,e){n||this.m(t,e)},o:L,d(t){t&&N(s)}}}function lt(t,e,s){const n=Object.create(t);return n.step=e[s],n.each_value=e,n.stepIndex=s,n}function ct(t){F(this,t),this._state=y(this.store._init(["results","setI","steps","isPlaying","stepI"]),t.data),this.store._add(this,["results","setI","steps","isPlaying","stepI"]),this._intro=!!t.intro,this._handlers.destroy=[V],t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,e){var s,n,o,i,r,a=[rt,at],l=[];function c(t){return t.$results[t.$setI]?0:1}return o=c(e),i=l[o]=a[o](t,e),{c(){s=k("div"),n=k("div"),i.c(),n.className="container",s.className="steps svelte-qp2iz6"},m(t,e){I(t,s,e),$(s,n),l[o].m(n,null),r=!0},p(e,s){var r=o;(o=c(s))===r?l[o].p(e,s):(i.o(function(){l[r].d(1),l[r]=null}),(i=l[o])||(i=l[o]=a[o](t,s)).c(),i.m(n,null))},i(t,e){r||this.m(t,e)},o(t){r&&(i.o(t),r=!1)},d(t){t&&N(s),l[o].d()}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,E(this._beforecreate),E(this._oncreate),E(this._aftercreate),this._lock=!1),this._intro=!0}function ut(t){F(this,t),this._state=y(this.store._init(["modals"]),t.data),this.store._add(this,["modals"]),this._intro=!!t.intro,this._handlers.destroy=[V],this._fragment=function(t,e){var s,n,o,i,r,a,l,c,u,h,d,p,m,f;function _(e){t.store.toggleModal("help",!1)}function v(e){t.store.toggleModal("help",!1)}return{c(){s=k("div"),n=k("div"),o=w("\r\n  "),i=k("div"),r=k("div"),(a=k("span")).textContent="Что делать?",l=w("\r\n      "),(c=k("span")).textContent="X",u=w("\r\n    "),(h=k("div")).innerHTML='<div class="columns"><div class="column col-12">1</div></div>\r\n      <div class="columns"><div class="column col-12">2</div></div>',d=w("\r\n    "),p=k("div"),P(n,"click",_),n.className="modal-overlay",a.className="h4",P(c,"click",v),c.className="btn btn-link float-right",r.className="modal-header",h.className="modal-body",p.className="modal-footer",i.className="modal-container",s.className=m="modal "+(e.$modals.help?"active":"")},m(t,e){I(t,s,e),$(s,n),$(s,o),$(s,i),$(i,r),$(r,a),$(r,l),$(r,c),$(i,u),$(i,h),$(i,d),$(i,p),f=!0},p(t,e){t.$modals&&m!==(m="modal "+(e.$modals.help?"active":""))&&(s.className=m)},i(t,e){f||this.m(t,e)},o:L,d(t){t&&N(s),j(n,"click",_),j(c,"click",v)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function ht(t){var e,s,n,o,i,r,a,l,c,u,h,d,p,m;F(this,t),this._state=y({},t.data),this._intro=!!t.intro,this._fragment=(e=this._state,{c(){s=k("div"),n=k("div"),o=w(e.hz),i=w(" Hz"),r=w("\r\n  "),a=k("div"),l=w(e.vol),c=w("%"),u=w("\r\n  "),h=k("div"),d=k("div"),p=k("div"),n.className="column col-2",a.className="column col-2",p.className="bar-item svelte-19d8d2i",M(p,"width",e.vol+"%"),d.className="bar",h.className="column col-8",s.className="columns"},m(t,e){I(t,s,e),$(s,n),$(n,o),$(n,i),$(s,r),$(s,a),$(a,l),$(a,c),$(s,u),$(s,h),$(h,d),$(d,p),m=!0},p(t,e){t.hz&&C(o,e.hz),t.vol&&(C(l,e.vol),M(p,"width",e.vol+"%"))},i(t,e){m||this.m(t,e)},o:L,d(t){t&&N(s)}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}y(Z.prototype,A),y(Z.prototype,Y),y(st.prototype,A),st.prototype._recompute=function(t,e){(t.$results||t.$setI||t.stepIndex)&&this._differs(e.volume,e.volume=function({$results:t,$setI:e,stepIndex:s}){return t[e][s]||X}(e))&&(t.volume=!0),(t.$results||t.$setI||t.isPlaying||t.stepIndex)&&this._differs(e.stepStateClass,e.stepStateClass=function({$results:t,$setI:e,isPlaying:s,stepIndex:n}){const o=t[e][n];return v(o)?s?"icon-music_note text-warning":"icon-done text-success":""}(e))&&(t.stepStateClass=!0)},y(ct.prototype,A),y(ut.prototype,A),y(ht.prototype,A);const dt=()=>{const t=new Date;return`${t.getHours()}:${t.getMinutes()}, ${t.getDate()}.${t.getMonth()+1}.${t.getFullYear()}`};var pt={print:()=>{window.print()}};function mt(t,e){var s,n={hz:e.$steps[e.i],vol:e.vol},o=new ht({root:t.root,store:t.store,data:n});return{c(){o._fragment.c()},m(t,e){o._mount(t,e),s=!0},p(t,e){var s={};t.$steps&&(s.hz=e.$steps[e.i]),t.completedSteps&&(s.vol=e.vol),o._set(s)},i(t,e){s||this.m(t,e)},o(t){s&&(o._fragment.o(t),s=!1)},d(t){o.destroy(t)}}}function ft(t,e){for(var s,n,o,i,r,a,l,c,u=e.completedSteps,h=[],d=0;d<u.length;d+=1)h[d]=mt(t,vt(e,u,d));function p(t,e,s){h[t]&&h[t].o(()=>{e&&(h[t].d(e),h[t]=null),s&&s()})}return{c(){s=k("span"),n=w("Аудиограмма пройдена: "),o=w(e.ts),i=w("\r\n        "),(r=k("div")).innerHTML='<div class="column col-2 text-italic">Частота</div>\r\n          <div class="column col-2 text-italic">Громкость</div>',a=w("\r\n\r\n        \r\n        ");for(var t=0;t<h.length;t+=1)h[t].c();l=S(),s.className="h5 svelte-tfakmb",r.className="columns report-head svelte-tfakmb"},m(t,e){I(t,s,e),$(s,n),$(s,o),I(t,i,e),I(t,r,e),I(t,a,e);for(var u=0;u<h.length;u+=1)h[u].i(t,e);I(t,l,e),c=!0},p(e,s){if(c&&!e.ts||C(o,s.ts),e.$steps||e.completedSteps){u=s.completedSteps;for(var n=0;n<u.length;n+=1){const o=vt(s,u,n);h[n]?h[n].p(e,o):(h[n]=mt(t,o),h[n].c()),h[n].i(l.parentNode,l)}for(;n<h.length;n+=1)p(n,1)}},i(t,e){c||this.m(t,e)},o(t){if(!c)return;const e=b(t,h.length);for(let t=0;t<h.length;t+=1)p(t,0,e);c=!1},d(t){t&&(N(s),N(i),N(r),N(a)),x(h,t),t&&N(l)}}}function _t(t,e){var s,n;return{c(){s=w("Нет данных для отчета")},m(t,e){I(t,s,e),n=!0},p:g,i(t,e){n||this.m(t,e)},o:L,d(t){t&&N(s)}}}function vt(t,e,s){const n=Object.create(t);return n.vol=e[s],n.each_value=e,n.i=s,n}function gt(t){F(this,t),this._state=y(this.store._init(["modals","results","setI","steps"]),t.data),this.store._add(this,["modals","results","setI","steps"]),this._recompute({$modals:1,isReportReady:1,$results:1,$setI:1},this._state),this._intro=!!t.intro,this._handlers.destroy=[V],t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,e){var s,n,o,i,r,a,l,c,u,h,d,p,m,f,_,v,g;function y(e){t.store.toggleModal("export",!1)}function b(e){t.store.toggleModal("export",!1)}var x=[ft,_t],S=[];function C(t){return t.isReportReady&&t.completedSteps.length?0:1}function M(e){t.print()}return d=C(e),p=S[d]=x[d](t,e),{c(){s=k("div"),n=k("div"),o=w("\r\n  "),i=k("div"),r=k("div"),(a=k("span")).textContent="Экспорт",l=w("\r\n      "),(c=k("span")).textContent="X",u=w("\r\n    "),h=k("div"),p.c(),m=w("\r\n    "),f=k("div"),(_=k("button")).textContent="Сохранить PDF",P(n,"click",y),n.className="modal-overlay",a.className="h4",P(c,"click",b),c.className="btn btn-link float-right",r.className="modal-header",h.id="report",h.className="modal-body svelte-tfakmb",P(_,"click",M),_.className="btn",f.className="modal-footer",i.className="modal-container",s.className=v="modal "+(e.$modals.export?"active":"")+" svelte-tfakmb"},m(t,e){I(t,s,e),$(s,n),$(s,o),$(s,i),$(i,r),$(r,a),$(r,l),$(r,c),$(i,u),$(i,h),S[d].m(h,null),$(i,m),$(i,f),$(f,_),g=!0},p(e,n){var o=d;(d=C(n))===o?S[d].p(e,n):(p.o(function(){S[o].d(1),S[o]=null}),(p=S[d])||(p=S[d]=x[d](t,n)).c(),p.m(h,null)),g&&!e.$modals||v===(v="modal "+(n.$modals.export?"active":"")+" svelte-tfakmb")||(s.className=v)},i(t,e){g||this.m(t,e)},o(t){g&&(p.o(t),g=!1)},d(t){t&&N(s),j(n,"click",y),j(c,"click",b),S[d].d(),j(_,"click",M)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,E(this._beforecreate),E(this._oncreate),E(this._aftercreate),this._lock=!1),this._intro=!0}function yt(t){var e,s;F(this,t),this._state=y({},t.data),this._intro=!!t.intro,this._fragment=(this._state,{c(){(e=k("footer")).innerHTML='<div class="container grid-xl text-right"><a href="https://github.com/aeroslav/audiogram2" target="_blank"><i class="icon icon-github"></i>\r\n      <span>GitHub repo</span></a></div>',e.className="bg-gray svelte-wwh7oi"},m(t,n){I(t,e,n),s=!0},p:g,i(t,e){s||this.m(t,e)},o:L,d(t){t&&N(e)}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function bt(t){var e,s,n,o,i,r,a,l,c,u,h,d,p,m;F(this,t),this._state=y({},t.data),this._intro=!!t.intro,t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=(e=this,this._state,c=new U({root:e.root,store:e.store}),u=new Z({root:e.root,store:e.store}),h=new ct({root:e.root,store:e.store}),d=new ut({root:e.root,store:e.store}),p=new yt({root:e.root,store:e.store}),m=new gt({root:e.root,store:e.store}),{c(){c._fragment.c(),s=w("\r\n"),n=k("main"),u._fragment.c(),o=w("\r\n  "),h._fragment.c(),i=w("\r\n  "),d._fragment.c(),r=w("\r\n"),p._fragment.c(),a=w("\r\n"),m._fragment.c(),n.className="container grid-xl svelte-urpqvi"},m(t,e){c._mount(t,e),I(t,s,e),I(t,n,e),u._mount(n,null),$(n,o),h._mount(n,null),$(n,i),d._mount(n,null),I(t,r,e),p._mount(t,e),I(t,a,e),m._mount(t,e),l=!0},p:g,i(t,e){l||this.m(t,e)},o(t){l&&(t=b(t,6),c._fragment.o(t),u._fragment.o(t),h._fragment.o(t),d._fragment.o(t),p._fragment.o(t),m._fragment.o(t),l=!1)},d(t){c.destroy(t),t&&(N(s),N(n)),u.destroy(),h.destroy(),d.destroy(),t&&N(r),p.destroy(t),t&&N(a),m.destroy(t)}}),this.root._oncreate.push(()=>{(function(){fetch(G).then(t=>t.json()).then(t=>{this.store.set({loadedSets:t})}).catch(t=>{console.log(t)})}).call(this),this.fire("update",{changed:function(t,e){for(var s in e)t[s]=1;return t}({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,E(this._beforecreate),E(this._oncreate),E(this._aftercreate),this._lock=!1),this._intro=!0}y(gt.prototype,A),y(gt.prototype,pt),gt.prototype._recompute=function(t,e){t.$modals&&this._differs(e.isReportReady,e.isReportReady=function({$modals:t}){return t.export}(e))&&(t.isReportReady=!0),t.isReportReady&&this._differs(e.ts,e.ts=function({isReportReady:t}){return t?dt():"-"}(e))&&(t.ts=!0),(t.$results||t.$setI)&&this._differs(e.completedSteps,e.completedSteps=function({$results:t,$setI:e}){return t&&t[e]?t[e].filter(t=>null!==t):[]}(e))&&(t.completedSteps=!0)},y(yt.prototype,A),y(bt.prototype,A);const $t=new class extends D{constructor(){super(),window.store=(()=>this.get()),this.set(B),this.compute("steps",["loadedSets","setI"],(t,e)=>v(e)&&t&&t[e]&&t[e].frequencies||[]),this.compute("hz",["loadedSets","setI","stepI"],(t,e,s)=>{const n=v(e)&&t&&t[e]&&t[e].frequencies;return n&&v(s)&&n[s]}),this.compute("volume",["results","setI","stepI"],(t,e,s)=>t[e]&&t[e][s]||0)}chooseSet(t){const{loadedSets:e,results:s}=this.get();let n={};if(v(t)&&t>-1){const o=e[t];n={setI:t,stepI:null},s[t]||(n={...n,results:{...s,[t]:new Array(o.frequencies.length).fill(null)}})}else n={setI:null,stepI:null};this.set(n)}playFrequency(t,e){const{stepI:s,isPlaying:n,results:o,setI:i}=this.get(),r=s!==t||!n;this.set({stepI:t||0}),this.setVolume(e||o[i][t]||X),this.set({isPlaying:r})}setVolume(t){const{results:e,setI:s,stepI:n}=this.get(),o=e[s],i=[].concat(o);t=+t,i[n]=t,v(t)&&this.set({results:{[s]:i}})}toggleModal(t,e){if(!t)return void console.warn("Specify modal name");const{modals:s}=this.get(),n="boolean"==typeof e?e:!s[t];this.set({modals:{...s,[t]:n}})}},It=new bt({target:document.body,store:$t}),Nt=new class{constructor(){this.context=new(window.AudioContext||window.webkitAudioContext),this.volume=this.context.createGain(),this.volume.connect(this.context.destination)}playFrequency(t){this.stop(),this.oscillator=this.context.createOscillator(),this.oscillator.type="sine",this.oscillator.connect(this.volume),this.oscillator.frequency.value=t,this.oscillator.start()}stop(){this.oscillator&&this.oscillator.stop()}setVolume(t){this.volume.gain.value=t/100}};return $t.on("state",({changed:t,current:e})=>{const{isPlaying:s,hz:n,volume:o}=e;t.isPlaying&&(s?Nt.playFrequency(n):Nt.stop()),t.hz&&s&&Nt.playFrequency(n),t.volume&&Nt.setVolume(o)}),It}();
